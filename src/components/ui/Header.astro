---
import ThemeToggle from "./ThemeToggle.astro";
import { tools } from "../../lib/tools";
---

<header
  class="sticky top-0 z-50 border-b border-neutral-200 bg-white/80 backdrop-blur-md dark:border-neutral-800 dark:bg-neutral-950/80"
>
  <div class="mx-auto flex h-14 max-w-5xl items-center justify-between px-6">
    <a
      href="/"
      class="flex items-center gap-2 text-sm font-semibold tracking-tight text-neutral-900 dark:text-neutral-100"
    >
      <span class="text-base">//</span>
      <span>devutils</span>
    </a>

    <button
      id="search-trigger"
      class="hidden items-center gap-2 rounded-md border border-neutral-200 px-3 py-1.5 text-sm text-neutral-400 transition-colors hover:border-neutral-300 hover:text-neutral-500 dark:border-neutral-800 dark:hover:border-neutral-700 dark:hover:text-neutral-300 sm:flex"
    >
      <svg
        class="h-4 w-4"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
      </svg>
      <span>Search tools...</span>
      <kbd
        class="rounded border border-neutral-200 px-1.5 py-0.5 text-xs dark:border-neutral-700"
      >
        <span class="search-shortcut-key">âŒ˜</span>K
      </kbd>
    </button>

    <nav class="flex items-center gap-1">
      <div class="group relative">
        <button
          class="px-3 py-2 text-sm text-neutral-600 transition-colors hover:text-neutral-900 dark:text-neutral-400 dark:hover:text-neutral-100"
        >
          Tools
        </button>
        <div
          class="invisible absolute right-0 top-full mt-1 w-56 rounded-md border border-neutral-200 bg-white opacity-0 shadow-lg transition-all group-hover:visible group-hover:opacity-100 dark:border-neutral-800 dark:bg-neutral-950"
        >
          <div class="max-h-80 overflow-y-auto py-1">
            {
              tools.map((tool) => (
                <a
                  href={`/${tool.slug}`}
                  class="block px-3 py-2 text-sm text-neutral-600 transition-colors hover:bg-neutral-50 hover:text-neutral-900 dark:text-neutral-400 dark:hover:bg-neutral-900 dark:hover:text-neutral-100"
                >
                  {tool.name}
                </a>
              ))
            }
          </div>
        </div>
      </div>

      <a
        href="https://github.com/Tyru5/devutils-tools"
        target="_blank"
        rel="noopener noreferrer"
        class="px-3 py-2 text-sm text-neutral-600 transition-colors hover:text-neutral-900 dark:text-neutral-400 dark:hover:text-neutral-100"
      >
        GitHub
      </a>

      <ThemeToggle />
    </nav>
  </div>
</header>

<script>
  const trigger = document.getElementById("search-trigger");
  const shortcutKey = document.querySelector(".search-shortcut-key");

  if (shortcutKey && !navigator.platform.toLowerCase().includes("mac")) {
    shortcutKey.textContent = "Ctrl+";
  }

  trigger?.addEventListener("click", () => {
    document.dispatchEvent(
      new KeyboardEvent("keydown", { key: "k", metaKey: true, ctrlKey: true }),
    );
  });
</script>
